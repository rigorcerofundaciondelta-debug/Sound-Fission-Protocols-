import React, { useState } from 'react';
import { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar } from 'recharts';
import { Calculator, Music, Brain, AlertCircle } from 'lucide-react';

const FrequencyStabilityAnalysis = () => {
  const [activeView, setActiveView] = useState('comparison');

  const frequencies = [
    {
      freq: 256,
      name: '256 Hz',
      factorization: '2‚Å∏',
      primeComplexity: 1,
      schumann: 256 / 33,
      predictedStability: 95,
      predictedE_fission: 3.8,
      predictedT_delta: 15.2,
      harmonicCleanliness: 100,
      notes: 'Do central (C4) en afinaci√≥n cient√≠fica',
      color: '#10b981'
    },
    {
      freq: 384,
      name: '384 Hz',
      factorization: '2‚Å∑ √ó 3',
      primeComplexity: 2,
      schumann: 384 / 49,
      predictedStability: 92,
      predictedE_fission: 3.6,
      predictedT_delta: 14.8,
      harmonicCleanliness: 95,
      notes: 'Sol (G4) en sistema pitag√≥rico',
      color: '#06b6d4'
    },
    {
      freq: 432,
      name: '432 Hz',
      factorization: '2‚Å¥ √ó 3¬≥',
      primeComplexity: 2,
      schumann: 432 / 55,
      predictedStability: 90,
      predictedE_fission: 3.24,
      predictedT_delta: 14.18,
      harmonicCleanliness: 90,
      notes: 'La (A4) - Verdi, datos emp√≠ricos del estudio',
      color: '#3b82f6',
      measured: true
    },
    {
      freq: 440,
      name: '440 Hz',
      factorization: '2¬≥ √ó 5 √ó 11',
      primeComplexity: 3,
      schumann: 440 / 56,
      predictedStability: 78,
      predictedE_fission: 2.83,
      predictedT_delta: 12.38,
      harmonicCleanliness: 72,
      notes: 'La (A4) - ISO 16:1975 est√°ndar',
      color: '#ef4444',
      measured: true
    },
    {
      freq: 444,
      name: '444 Hz',
      factorization: '2¬≤ √ó 3 √ó 37',
      primeComplexity: 3,
      schumann: 444 / 57,
      predictedStability: 75,
      predictedE_fission: 2.7,
      predictedT_delta: 12.1,
      harmonicCleanliness: 68,
      notes: 'Usado en algunos sistemas de afinaci√≥n',
      color: '#f59e0b'
    },
    {
      freq: 528,
      name: '528 Hz',
      factorization: '2‚Å¥ √ó 3 √ó 11',
      primeComplexity: 3,
      schumann: 528 / 67,
      predictedStability: 76,
      predictedE_fission: 2.65,
      predictedT_delta: 11.85,
      harmonicCleanliness: 70,
      notes: 'Frecuencia "solfeggio" (controvertida)',
      color: '#8b5cf6'
    },
    {
      freq: 396,
      name: '396 Hz',
      factorization: '2¬≤ √ó 3¬≤ √ó 11',
      primeComplexity: 3,
      schumann: 396 / 51,
      predictedStability: 80,
      predictedE_fission: 2.9,
      predictedT_delta: 12.8,
      harmonicCleanliness: 75,
      notes: 'Frecuencia "solfeggio"',
      color: '#ec4899'
    }
  ];

  const radarData = frequencies.map(f => ({
    frequency: f.name,
    'Estabilidad': f.predictedStability,
    'Limpieza Arm√≥nica': f.harmonicCleanliness,
    'E_fission': f.predictedE_fission * 10,
    'T_Œî': f.predictedT_delta * 6,
    'Simplicidad': 100 - (f.primeComplexity * 15)
  }));

  const comparisonData = frequencies.map(f => ({
    name: f.name,
    E_fission: f.predictedE_fission,
    T_delta: f.predictedT_delta,
    stability: f.predictedStability,
    measured: f.measured
  }));

  return (
    <div className="w-full max-w-7xl mx-auto p-6 bg-gradient-to-br from-slate-50 to-blue-50 min-h-screen">
      <div className="bg-white rounded-lg shadow-xl p-6 mb-6">
        <div className="flex items-center gap-3 mb-4">
          <Music className="w-8 h-8 text-blue-600" />
          <h1 className="text-3xl font-bold text-slate-800">
            ¬øEstabilidad Ac√∫stica Exclusiva del 432 Hz?
          </h1>
        </div>
        
        <div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 rounded">
          <div className="flex items-start gap-3">
            <AlertCircle className="w-6 h-6 text-yellow-600 flex-shrink-0 mt-1" />
            <div>
              <p className="font-semibold text-yellow-900">Respuesta: NO</p>
              <p className="text-yellow-800 text-sm mt-1">
                La estabilidad ac√∫stica NO es exclusiva del 432 Hz. M√∫ltiples frecuencias 
                pueden exhibir alta estabilidad seg√∫n su factorizaci√≥n matem√°tica y 
                propiedades arm√≥nicas.
              </p>
            </div>
          </div>
        </div>

        <div className="flex flex-wrap gap-2 mb-6">
          <button
            onClick={() => setActiveView('comparison')}
            className={`px-4 py-2 rounded-lg font-medium transition-all ${
              activeView === 'comparison'
                ? 'bg-blue-600 text-white shadow-md'
                : 'bg-slate-200 text-slate-700 hover:bg-slate-300'
            }`}
          >
            Comparaci√≥n por Par√°metros
          </button>
          <button
            onClick={() => setActiveView('radar')}
            className={`px-4 py-2 rounded-lg font-medium transition-all ${
              activeView === 'radar'
                ? 'bg-blue-600 text-white shadow-md'
                : 'bg-slate-200 text-slate-700 hover:bg-slate-300'
            }`}
          >
            Vista Multidimensional
          </button>
          <button
            onClick={() => setActiveView('table')}
            className={`px-4 py-2 rounded-lg font-medium transition-all ${
              activeView === 'table'
                ? 'bg-blue-600 text-white shadow-md'
                : 'bg-slate-200 text-slate-700 hover:bg-slate-300'
            }`}
          >
            Tabla Detallada
          </button>
        </div>

        {activeView === 'comparison' && (
          <div className="space-y-6">
            <div className="bg-slate-50 p-4 rounded-lg">
              <h3 className="font-semibold text-lg mb-3 flex items-center gap-2">
                <Calculator className="w-5 h-5 text-blue-600" />
                Energ√≠a de Fisi√≥n (E_fission)
              </h3>
              <p className="text-sm text-slate-600 mb-4">
                Mayor valor = Mayor estabilidad espectral
              </p>
              <ResponsiveContainer width="100%" height={300}>
                <BarChart data={comparisonData}>
                  <CartesianGrid strokeDasharray="3 3" />
                  <XAxis dataKey="name" />
                  <YAxis label={{ value: 'E_fission (dB)', angle: -90, position: 'insideLeft' }} />
                  <Tooltip />
                  <Bar dataKey="E_fission" fill="#3b82f6" />
                </BarChart>
              </ResponsiveContainer>
            </div>

            <div className="bg-slate-50 p-4 rounded-lg">
              <h3 className="font-semibold text-lg mb-3 flex items-center gap-2">
                <Brain className="w-5 h-5 text-purple-600" />
                Umbral de Desincronizaci√≥n (T_Œî)
              </h3>
              <p className="text-sm text-slate-600 mb-4">
                Mayor valor = Mayor tolerancia temporal
              </p>
              <ResponsiveContainer width="100%" height={300}>
                <BarChart data={comparisonData}>
                  <CartesianGrid strokeDasharray="3 3" />
                  <XAxis dataKey="name" />
                  <YAxis label={{ value: 'T_Œî (ms)', angle: -90, position: 'insideLeft' }} />
                  <Tooltip />
                  <Bar dataKey="T_delta" fill="#8b5cf6" />
                </BarChart>
              </ResponsiveContainer>
            </div>
          </div>
        )}

        {activeView === 'radar' && (
          <div className="bg-slate-50 p-6 rounded-lg">
            <h3 className="font-semibold text-lg mb-4 text-center">
              An√°lisis Multidimensional de Estabilidad
            </h3>
            <ResponsiveContainer width="100%" height={500}>
              <RadarChart data={radarData}>
                <PolarGrid />
                <PolarAngleAxis dataKey="frequency" />
                <PolarRadiusAxis angle={90} domain={[0, 100]} />
                {frequencies.map((f, idx) => (
                  <Radar
                    key={f.freq}
                    name={f.name}
                    dataKey="Estabilidad"
                    stroke={f.color}
                    fill={f.color}
                    fillOpacity={0.1}
                  />
                ))}
                <Legend />
                <Tooltip />
              </RadarChart>
            </ResponsiveContainer>
            <p className="text-sm text-slate-600 text-center mt-4">
              Valores normalizados a escala 0-100 para comparaci√≥n visual
            </p>
          </div>
        )}

        {activeView === 'table' && (
          <div className="overflow-x-auto rounded-lg border border-slate-200">
            <table className="w-full text-sm">
              <thead className="bg-slate-100">
                <tr>
                  <th className="p-3 text-left">Frecuencia</th>
                  <th className="p-3 text-left">Factorizaci√≥n</th>
                  <th className="p-3 text-right">E_fission (dB)</th>
                  <th className="p-3 text-right">T_Œî (ms)</th>
                  <th className="p-3 text-right">Estabilidad</th>
                  <th className="p-3 text-left">Notas</th>
                </tr>
              </thead>
              <tbody>
                {frequencies.map((f) => (
                  <tr 
                    key={f.freq} 
                    className={`border-b ${f.measured ? 'bg-blue-50' : ''} hover:bg-slate-50 transition-colors`}
                  >
                    <td className="p-3 font-semibold" style={{color: f.color}}>
                      {f.name} {f.measured && '‚úì'}
                    </td>
                    <td className="p-3 font-mono text-xs">{f.factorization}</td>
                    <td className="p-3 text-right font-semibold">{f.predictedE_fission.toFixed(2)}</td>
                    <td className="p-3 text-right font-semibold">{f.predictedT_delta.toFixed(2)}</td>
                    <td className="p-3 text-right">
                      <span className={`px-2 py-1 rounded text-xs font-medium ${
                        f.predictedStability >= 90 ? 'bg-green-100 text-green-800' :
                        f.predictedStability >= 80 ? 'bg-blue-100 text-blue-800' :
                        'bg-yellow-100 text-yellow-800'
                      }`}>
                        {f.predictedStability}%
                      </span>
                    </td>
                    <td className="p-3 text-xs text-slate-600">{f.notes}</td>
                  </tr>
                ))}
              </tbody>
            </table>
            <div className="mt-4 p-4 text-xs text-slate-600 bg-slate-50">
              <p className="mb-1">‚úì = Datos medidos emp√≠ricamente en el estudio</p>
              <p>Sin ‚úì = Predicciones te√≥ricas basadas en el Modelo de Coherencia Sonora</p>
            </div>
          </div>
        )}

        <div className="mt-8 grid md:grid-cols-2 gap-4">
          <div className="bg-green-50 border border-green-200 rounded-lg p-4">
            <h4 className="font-semibold text-green-900 mb-2">
              ‚úÖ Frecuencias con Mayor Estabilidad Predicha
            </h4>
            <ul className="text-sm text-green-800 space-y-1">
              <li>‚Ä¢ <strong>256 Hz</strong>: Factorizaci√≥n m√°s simple (2‚Å∏)</li>
              <li>‚Ä¢ <strong>384 Hz</strong>: Solo potencias de 2 y 3</li>
              <li>‚Ä¢ <strong>432 Hz</strong>: Datos emp√≠ricos confirmados</li>
            </ul>
          </div>

          <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
            <h4 className="font-semibold text-blue-900 mb-2">
              üî¨ Principio Unificador
            </h4>
            <p className="text-sm text-blue-800 mb-2">
              La estabilidad ac√∫stica se correlaciona con:
            </p>
            <ul className="text-sm text-blue-800 space-y-1">
              <li>‚Ä¢ Simplicidad de factorizaci√≥n prima</li>
              <li>‚Ä¢ Ausencia de factores primos grandes (‚â•11)</li>
              <li>‚Ä¢ Predominancia de potencias de 2 y 3</li>
            </ul>
          </div>
        </div>

        <div className="mt-6 bg-amber-50 border-l-4 border-amber-500 p-4 rounded">
          <p className="text-sm text-amber-900 font-semibold mb-2">
            ‚ö†Ô∏è IMPORTANTE: Limitaci√≥n del Estudio Original
          </p>
          <p className="text-sm text-amber-800">
            El estudio solo compar√≥ 432 Hz vs 440 Hz. Los valores para otras frecuencias 
            son <strong>predicciones te√≥ricas</strong> basadas en el Modelo de Coherencia Sonora, 
            pero <strong>NO han sido medidos emp√≠ricamente</strong>. Se requiere investigaci√≥n 
            adicional para confirmar estas predicciones.
          </p>
        </div>
      </div>
    </div>
  );
};

export default FrequencyStabilityAnalysis;
